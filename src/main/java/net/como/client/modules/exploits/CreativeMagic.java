package net.como.client.modules.exploits;

import java.util.HashMap;
import java.util.function.Supplier;

import net.como.client.items.FunnySword;
import net.como.client.structures.CreativeItem;
import net.como.client.structures.Module;
import net.como.client.utils.NbtUtils;
import net.fabricmc.fabric.api.client.itemgroup.FabricItemGroupBuilder;
import net.minecraft.item.ItemGroup;
import net.minecraft.item.ItemStack;
import net.minecraft.item.Items;
import net.minecraft.nbt.NbtCompound;
import net.minecraft.util.Identifier;

public class CreativeMagic extends Module {

    public final static Identifier GROUP_ID = new Identifier("como-client:creative_magic"); 

    @Override
    public boolean shouldDisplayInModList() {
        return false;
    }

    public CreativeMagic() {
        super("CreativeMagic", true);
    
        this.description = "Adds a creative item group with custom NBT items.";

        this.setCategory("Exploits");
    }
    
    private Supplier<ItemStack> iconSupplier = new Supplier<ItemStack>() {
        public ItemStack get() {
            return new ItemStack(Items.TNT);
        }
    };

    public void refreshItems() {
        items.clear();
    }

    private FabricItemGroupBuilder builder;
    private HashMap<String, ItemStack> items = new HashMap<>();

    // Used to register new items
    public void addItem(String name, ItemStack item) {
        this.items.put(name, item);
    }


    private ItemGroup group;

    @Override
    public void activate() {
        this.refreshItems();

        if (this.builder != null) return;

        this.builder = FabricItemGroupBuilder.create(GROUP_ID);
        builder.icon(this.iconSupplier);

        builder.appendItems((stacks, itemGroup) -> {
            for (ItemStack stack : this.items.values()) {
                stacks.add(stack);
            }
        });

        this.group = this.builder.build();
    }

    @Override
    public void deactivate() {
        // TODO hide it or delete it
    }
}
